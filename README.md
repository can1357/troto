# Troto

Troto is a replacement for the protobuf compiler that can generate `.proto` files from TypeScript types as well as invoke any plugins without even needing protoc installed. This leads to a much better experience as TypeScript is much more powerful than the `.proto` language and allows automatic service `XxxRequest`/`XxxResponse` generation, generics, and much more.

# Example

To start with generating `.proto` files from TypeScript types, you can use the following code:

```typescript
interface Vector3<T> {
	x$1: T;
	y$2: T;
	z$3: T;
}

export interface Vector3f extends Vector3<float> {}
export interface Vector3d extends Vector3<double> {}
export interface Vector3i extends Vector3<int32> {}

export interface VectorService {
	MulF32(v: Vector3f, f: float): Vector3f;
	MulF64(v: Vector3d, d: double): Vector3d;
	MulI32(v: Vector3i, i: int32): Vector3i;
}
```

```json
{
	"compilerOptions": {
		"strict": true,
		"outDir": "./dist/proto",
		"types": ["troto-prototypes"]
	}
}
```

```shell
trotoc ./path/to/ts
```

This will generate the following `.proto` files:

```protobuf
// Code generated by Troto. DO NOT EDIT.
syntax = "proto3";
package test;
message Vector3f {
	float x = 1;
	float y = 2;
	float z = 3;
}
message Vector3d {
	double x = 1;
	double y = 2;
	double z = 3;
}
message Vector3i {
	int32 x = 1;
	int32 y = 2;
	int32 z = 3;
}
service VectorService {
	rpc MulF32 (MulF32Request) returns (Vector3f);
	rpc MulF64 (MulF64Request) returns (Vector3d);
	rpc MulI32 (MulI32Request) returns (Vector3i);
}
message MulF32Request {
	Vector3f v = 1;
	float f = 2;
}
message MulF64Request {
	Vector3d v = 1;
	double d = 2;
}
message MulI32Request {
	Vector3i v = 1;
	int32 i = 2;
}
```

Neat, right? You can now use this `.proto` file to generate code in any language you want.

Alternatively, we can generate this code by completely skipping protoc step.

Let's modify the tsconfig.json file:

```json
{
	"compilerOptions": {
		"strict": true,
		"outDir": "./dist/proto",
		"types": ["troto-prototypes"]
	},
	"troto": {
		"plugins": {
			"go": {
				"outDir": "./dist/go",
				"paths": "source_relative"
			}
		}
	}
}
```

```shell
trotoc ./path/to/ts
```

This will generate both the `.proto` files and the Go code in the `./dist/go` directory. No more need for protoc!
